---
title: '–í—ã—á–∏—Å–ª–µ–Ω–∏–µ N-–≥–æ –∑–Ω–∞–∫–∞ —á–∏—Å–ª–∞ –ü–∏ –±–µ–∑ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö'
description: '–° –Ω–µ–¥–∞–≤–Ω–∏—Ö –ø–æ—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ –ü–∏, –∫–æ—Ç–æ—Ä—É—é –≤ 1995 –≥–æ–¥—É –≤–ø–µ—Ä–≤—ã–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ –î—ç–≤–∏–¥ –ë—ç–π–ª–∏, –ü–∏—Ç–µ—Ä –ë–æ—Ä–≤–∞–π–Ω –∏ –°–∞–π–º–æ–Ω –ü–ª–∞—Ñ—Ñ'
pubDate: 'May 15 2013'
original: 'https://habr.com/en/articles/179829/'
license: 'cc'
emoji: 'üî¢'
tags: ['tutorial']
lang: 'ru'
---

–° –Ω–µ–¥–∞–≤–Ω–∏—Ö –ø–æ—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —á–∏—Å–ª–∞ –ü–∏, –∫–æ—Ç–æ—Ä—É—é –≤ 1995 –≥–æ–¥—É –≤–ø–µ—Ä–≤—ã–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏ –î—ç–≤–∏–¥ –ë—ç–π–ª–∏, –ü–∏—Ç–µ—Ä –ë–æ—Ä–≤–∞–π–Ω –∏ –°–∞–π–º–æ–Ω –ü–ª–∞—Ñ—Ñ

![–§–æ—Ä–º—É–ª–∞ –ë—ç–π–ª–∏-–ë–æ—Ä–≤–∞–π–Ω–∞-–ü–ª–∞—Ñ—Ñ–∞](../../blog-images/nth-digit-of-pi.png)

–ö–∞–∑–∞–ª–æ—Å—å –±—ã: —á—Ç–æ –≤ –Ω–µ–π –æ—Å–æ–±–µ–Ω–Ω–æ–≥–æ ‚Äî —Ñ–æ—Ä–º—É–ª –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ü–∏ –≤–µ–ª–∏–∫–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ: –æ—Ç —à–∫–æ–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –ú–æ–Ω—Ç–µ-–ö–∞—Ä–ª–æ –¥–æ —Ç—Ä—É–¥–Ω–æ–ø–æ—Å—Ç–∏–∂–∏–º–æ–≥–æ –∏–Ω—Ç–µ–≥—Ä–∞–ª–∞ –ü—É–∞—Å—Å–æ–Ω–∞ –∏ —Ñ–æ—Ä–º—É–ª—ã –§—Ä–∞–Ω—Å—É–∞ –í–∏–µ—Ç–∞ –∏–∑ –ø–æ–∑–¥–Ω–µ–≥–æ –°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—å—è. –ù–æ –∏–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç—É —Ñ–æ—Ä–º—É–ª—É —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ ‚Äî –æ–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—á–∏—Å–ª–∏—Ç—å n-–π –∑–Ω–∞–∫ —á–∏—Å–ª–∞ –ø–∏ –±–µ–∑ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö. –ó–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–æ–º, –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ —Ç–∞–∫–∂–µ –∑–∞ –≥–æ—Ç–æ–≤—ã–º –∫–æ–¥–æ–º –Ω–∞ —è–∑—ã–∫–µ C, –≤—ã—á–∏—Å–ª—è—é—â–∏–º 1 000 000-–π –∑–Ω–∞–∫, –ø—Ä–æ—à—É –ø–æ–¥ —Ö–∞–±—Ä–∞–∫–∞—Ç.

–ö–∞–∫ –∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã—á–∏—Å–ª–µ–Ω–∏—è N-–≥–æ –∑–Ω–∞–∫–∞ –ü–∏?
–ö –ø—Ä–∏–º–µ—Ä—É, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–µ–Ω 1000-–π —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã–π –∑–Ω–∞–∫ —á–∏—Å–ª–∞ –ü–∏, –º—ã –¥–æ–º–Ω–æ–∂–∞–µ–º –≤—Å—é —Ñ–æ—Ä–º—É–ª—É –Ω–∞ 16^1000, —Ç–µ–º —Å–∞–º—ã–º –æ–±—Ä–∞—â–∞—è –º–Ω–æ–∂–∏—Ç–µ–ª—å, —Å—Ç–æ—è—â–∏–π –ø–µ—Ä–µ–¥ —Å–∫–æ–±–∫–∞–º–∏, –≤ 16^(1000-k). –ü—Ä–∏ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–∏ –≤ —Å—Ç–µ–ø–µ–Ω—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º [–¥–≤–æ–∏—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–µ–ø–µ–Ω—å](http://brtrg.com/blog/post/514) –∏–ª–∏, –∫–∞–∫ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ, [–≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å –ø–æ –º–æ–¥—É–ª—é](https://en.wikipedia.org/wiki/Modular_exponentiation). –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã—á–∏—Å–ª—è–µ–º —Å—É–º–º—É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–ª–µ–Ω–æ–≤ —Ä—è–¥–∞. –ü—Ä–∏—á—ë–º –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è—Ç—å –º–Ω–æ–≥–æ: –ø–æ –º–µ—Ä–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è k 16^(N-k) –±—ã—Å—Ç—Ä–æ —É–±—ã–≤–∞–µ—Ç, —Ç–∞–∫ —á—Ç–æ, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —á–ª–µ–Ω—ã –Ω–µ –±—É–¥—É—Ç –æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏—è –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –∏—Å–∫–æ–º—ã—Ö —Ü–∏—Ñ—Ä. –í–æ—Ç –∏ –≤—Å—è –º–∞–≥–∏—è ‚Äî –≥–µ–Ω–∏–∞–ª—å–Ω–∞—è –∏ –ø—Ä–æ—Å—Ç–∞—è.

–§–æ—Ä–º—É–ª–∞ –ë—ç–π–ª–∏-–ë–æ—Ä–≤–∞–π–Ω–∞-–ü–ª–∞—Ñ—Ñ–∞ –±—ã–ª–∞ –Ω–∞–π–¥–µ–Ω–∞ –°–∞–π–º–æ–Ω–æ–º –ü–ª–∞—Ñ—Ñ–æ–º –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ [PSLQ](http://www.cecm.sfu.ca/organics/papers/bailey/paper/html/node3.html), –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –≤ 2000 –≥–æ–¥—É –≤–∫–ª—é—á—ë–Ω –≤ —Å–ø–∏—Å–æ–∫ [Top 10 Algorithms of the Century](http://orion.math.iastate.edu/burkardt/misc/algorithms_dongarra.html). –°–∞–º –∂–µ –∞–ª–≥–æ—Ä–∏—Ç–º PSLQ –±—ã–ª –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ë—ç–π–ª–∏. –í–æ—Ç —Ç–∞–∫–æ–π –º–µ–∫—Å–∏–∫–∞–Ω—Å–∫–∏–π —Å–µ—Ä–∏–∞–ª –ø—Ä–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–æ–≤.
–ö—Å—Ç–∞—Ç–∏, –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ ‚Äî O(N), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ ‚Äî O(log N), –≥–¥–µ N ‚Äî –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –∏—Å–∫–æ–º–æ–≥–æ –∑–Ω–∞–∫–∞.

–î—É–º–∞—é, —É–º–µ—Å—Ç–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫–æ–¥ –Ω–∞ —è–∑—ã–∫–µ –°–∏, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∞–≤—Ç–æ—Ä–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –î—ç–≤–∏–¥–æ–º –ë—ç–π–ª–∏:

```c
/*  
    This program implements the BBP algorithm to generate a few hexadecimal
    digits beginning immediately after a given position id, or in other words
    beginning at position id + 1.  On most systems using IEEE 64-bit floating-
    point arithmetic, this code works correctly so long as d is less than
    approximately 1.18 x 10^7.  If 80-bit arithmetic can be employed, this limit
    is significantly higher.  Whatever arithmetic is used, results for a given
    position id can be checked by repeating with id-1 or id+1, and verifying 
    that the hex digits perfectly overlap with an offset of one, except possibly
    for a few trailing digits.  The resulting fractions are typically accurate 
    to at least 11 decimal digits, and to at least 9 hex digits.  
*/

/*  David H. Bailey     2006-09-08 */

#include <stdio.h>
#include <math.h>

int main()
{
  double pid, s1, s2, s3, s4;
  double series (int m, int n);
  void ihex (double x, int m, char c[]);
  int id = 1000000;
#define NHX 16
  char chx[NHX];

/*  id is the digit position.  Digits generated follow immediately after id. */

  s1 = series (1, id);
  s2 = series (4, id);
  s3 = series (5, id);
  s4 = series (6, id);
  pid = 4. * s1 - 2. * s2 - s3 - s4;
  pid = pid - (int) pid + 1.;
  ihex (pid, NHX, chx);
  printf (" position = %i\n fraction = %.15f \n hex digits =  %10.10s\n",
  id, pid, chx);
}

void ihex (double x, int nhx, char chx[])

/*  This returns, in chx, the first nhx hex digits of the fraction of x. */

{
  int i;
  double y;
  char hx[] = "0123456789ABCDEF";

  y = fabs (x);

  for (i = 0; i < nhx; i++){
    y = 16. * (y - floor (y));
    chx[i] = hx[(int) y];
  }
}

double series (int m, int id)

/*  This routine evaluates the series  sum_k 16^(id-k)/(8*k+m) 
    using the modular exponentiation technique. */

{
  int k;
  double ak, eps, p, s, t;
  double expm (double x, double y);
#define eps 1e-17

  s = 0.;

/*  Sum the series up to id. */

  for (k = 0; k < id; k++){
    ak = 8 * k + m;
    p = id - k;
    t = expm (p, ak);
    s = s + t / ak;
    s = s - (int) s;
  }

/*  Compute a few terms where k >= id. */

  for (k = id; k <= id + 100; k++){
    ak = 8 * k + m;
    t = pow (16., (double) (id - k)) / ak;
    if (t < eps) break;
    s = s + t;
    s = s - (int) s;
  }
  return s;
}

double expm (double p, double ak)

/*  expm = 16^p mod ak.  This routine uses the left-to-right binary 
    exponentiation scheme. */

{
  int i, j;
  double p1, pt, r;
#define ntp 25
  static double tp[ntp];
  static int tp1 = 0;

/*  If this is the first call to expm, fill the power of two table tp. */

  if (tp1 == 0) {
    tp1 = 1;
    tp[0] = 1.;

    for (i = 1; i < ntp; i++) tp[i] = 2. * tp[i-1];
  }

  if (ak == 1.) return 0.;

/*  Find the greatest power of two less than or equal to p. */

  for (i = 0; i < ntp; i++) if (tp[i] > p) break;

  pt = tp[i-1];
  p1 = p;
  r = 1.;

/*  Perform binary exponentiation algorithm modulo ak. */

  for (j = 1; j <= i; j++){
    if (p1 >= pt){
      r = 16. * r;
      r = r - (int) (r / ak) * ak;
      p1 = p1 - pt;
    }
    pt = 0.5 * pt;
    if (pt >= 1.){
      r = r * r;
      r = r - (int) (r / ak) * ak;
    }
  }

  return r;
}
```

–ö–∞–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —ç—Ç–æ –¥–∞—ë—Ç? –ù–∞–ø—Ä–∏–º–µ—Ä: –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—â—É—é —á–∏—Å–ª–æ –ü–∏ –∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ–º –•–∞–±—Ä–æ–º –Ω–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (–∫–æ—Ç–æ—Ä—ã–π —Å–µ–π—á–∞—Å, –∫ —Å–ª–æ–≤—É, —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 10 —Ç—Ä–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π). –°–æ–≥–ª–∞—Å–Ω–æ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–º –¥–∞–Ω–Ω—ã–º, –¥—Ä–æ–±–Ω–∞—è —á–∞—Å—Ç—å —á–∏—Å–ª–∞ –ü–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–æ—Ä–º–∞–ª—å–Ω—É—é —á–∏—Å–ª–æ–≤—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Ö–æ—Ç—è –¥–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ –µ—â—ë –Ω–µ —É–¥–∞–ª–æ—Å—å), –∞ –∑–Ω–∞—á–∏—Ç, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ü–∏—Ñ—Ä –∏–∑ –Ω–µ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª–µ–π –∏ –ø—Ä–æ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª, –∏–ª–∏ –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–∏). –°–ø–æ—Å–æ–±–æ–≤ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤–µ–ª–∏–∫–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ ‚Äî –Ω–∞–¥–æ —Ç–æ–ª—å–∫–æ –≤–∫–ª—é—á–∏—Ç—å —Ñ–∞–Ω—Ç–∞–∑–∏—é.

–ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —Ç–µ–º–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –≤ [—Å—Ç–∞—Ç—å–µ —Å–∞–º–æ–≥–æ –î—ç–≤–∏–¥–∞ –ë—ç–π–ª–∏](http://www.experimentalmath.info/bbp-codes/bbp-alg.pdf), –≥–¥–µ –æ–Ω –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ –∞–ª–≥–æ—Ä–∏—Ç–º –∏ –µ–≥–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—é;

–ò, –ø–æ—Ö–æ–∂–µ, –≤—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –ø–µ—Ä–≤—É—é —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—É—é —Å—Ç–∞—Ç—å—é –æ–± —ç—Ç–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–µ –≤ —Ä—É–Ω–µ—Ç–µ ‚Äî –¥—Ä—É–≥–∏—Ö —è –Ω–∞–π—Ç–∏ –Ω–µ —Å–º–æ–≥.
